<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Countdown Timer</title>
<style>
  body {
    background: #000;
    color: #0ff;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 100vh;
    font-family: 'Arial', sans-serif;
  }

  .timer {
    display: flex;
    gap: 10px;
    font-size: 4rem;
    font-weight: bold;
    text-shadow: 0 0 5px #0ff, 0 0 10px #0ff, 0 0 20px #0ff;
  }

  .digit {
    display: inline-block;
    perspective: 1000px;
  }

  .flip {
    display: inline-block;
    transform-origin: bottom;
    animation: flip 0.6s ease-in-out forwards;
  }

  @keyframes flip {
    0% { transform: rotateX(0deg); }
    50% { transform: rotateX(-90deg); }
    100% { transform: rotateX(0deg); }
  }

  .message {
    margin-top: 20px;
    font-size: 1rem;
    max-width: 600px;
    text-align: center;
    color: #0ff;
    text-shadow: 0 0 5px #0ff, 0 0 10px #0ff;
  }
</style>
</head>
<body>

<div class="timer" id="timer">
  <span class="digit" id="days">0</span>日
  <span class="digit" id="hours">0</span>時間
  <span class="digit" id="minutes">0</span>分
  <span class="digit" id="seconds">0</span>秒
</div>
<div class="message" id="message">カウントダウンメッセージがここに表示されます。</div>

<script>
  const API_KEY = "AIzaSyCoOrWTtz2ZrjNOQwv_89XjtstKU3e2r-U"; // 取得済みキー
  const CALENDAR_ID = "japanese__ja@holiday.calendar.google.com";

  let holidayDate = null; // ここに「次の3日以上連休開始日」を入れる

  // 1日〜100日のメッセージ（例として最初の3日分だけ記載。必要に応じて100日分埋めてください）
  const dayMessages = {
  1: "地球での1日は、火星では約24時間39分、木星では約9時間56分です。火星は地球と自転周期が似ているので、地球にいる時とあまり変わらない感覚で過ごせそうですね。",
  2: "地球で2日を過ごしても、金星ではまだ1日の半分にも満たない時間です。向こうの人たちは、ようやくランチを食べ始めた頃かもしれません。",
  3: "地球で3日を過ごすと、巨大ガス惑星の木星では約7.5日分、土星では約7.6日分に相当します。向こうではもう週明けみたいです。",
  4: "地球での4日は、天王星では約6.8日分です。天王星の1日は約17時間なので、向こうで過ごせば、1日に2回は朝を迎えることができます。",
  5: "地球の5日は、海王星では約7.4日分です。海王星では、あっという間に1週間が過ぎてしまいそうですね。",
  6: "地球の6日は、冥王星ではまだ1日の半分以下です。冥王星の住人は、まだ朝のコーヒーを淹れている頃かもしれません。",
  7: "地球での7日を過ごせば、太陽系の全ての惑星で1日以上を過ごせます。でも、金星ではまだ朝ご飯の時間帯にもなっていません。",
  8: "地球で8日を過ごしても、水星ではまだ夜明け前です。水星の1日は地球の約176日分なので、朝までが遠いですね。",
  9: "地球で9日を過ごせば、木星では約21.8日分に相当し、3週間近くになります。もうすっかり木星の住人になれそうです。",
  10: "地球での10日は、火星では約9.7日分、土星では約24日分に相当します。土星では、あっという間に1ヶ月が過ぎてしまいそうです。",
  11: "地球の11日は、海王星では約16.3日分に相当します。気づけば半月が経ってしまいます。",
  12: "地球での12日は、水星ではまだ夜明け前です。水星の人たちは、もう少し寝ていたいようです。",
  13: "地球の13日を過ごせば、冥王星ではようやく2日目に入ります。",
  14: "地球で14日は、水星ではまだ夜明け前です。水星の人たちは、のんびりした生活を送っていそうです。",
  15: "地球の15日を過ごしても、金星ではまだ1日の16分の1です。ようやく歯磨きが終わった頃かもしれません。",
  16: "地球での16日を過ごせば、木星では約38.5日分、土星では約38.4日分に相当し、1ヶ月以上になります。地球にいる間に、向こうでは1ヶ月以上が過ぎてしまいます。",
  17: "地球で17日は、水星ではまだ夜明け前です。水星の朝は本当に長いですね。",
  18: "地球での18日を過ごしても、金星ではまだ1日の13分の1です。向こうでは、ようやく朝の支度が始まったばかりかもしれません。",
  19: "地球の19日は、木星では約45.8日分、土星では約45.6日分に相当します。向こうではあっという間に冬が来て、あっという間に春が来そうです。",
  20: "地球で20日を過ごしても、水星ではまだ夜明け前です。水星の住人たちは、まだ夢の中かもしれません。",
  21: "地球の21日は、木星では約50.6日分、土星では約50.4日分に相当します。もうすっかり向こうの生活にも慣れましたか？",
  22: "地球での22日は、水星ではまだ夜明け前です。水星の人たちは、夜更かしが好きなのかもしれません。",
  23: "地球の23日を過ごしても、金星ではまだ1日の10分の1です。やっと朝のコーヒーを淹れ始めた頃でしょうか。",
  24: "地球で24日は、天王星では約33.8日分に相当し、1ヶ月以上になります。天王星に引っ越したら、あっという間に給料日を迎えられそうですね。",
  25: "地球での25日を過ごしても、水星ではまだ夜明け前です。水星の夜は本当に長いです。",
  26: "地球で26日を過ごせば、冥王星では約4日目に入ります。向こうの住人たちは、ようやく休日の計画を立て始めた頃かもしれません。",
  27: "地球の27日は、木星では約65日分、土星では約64.8日分に相当します。もうすっかりベテランの木星住人です。",
  28: "地球での28日を過ごしても、水星ではまだ夜明け前です。水星の人たちは、朝が来るのを待ちわびているかもしれません。",
  29: "地球の29日を過ごしても、金星ではまだ1日の8分の1です。やっと朝の歯磨きを始めた頃でしょうか。",
  30: "地球で30日を過ごしても、水星ではまだ夜明け前です。水星の人たちは、夜の間にたっぷり充電できそうですね。",
  31: "地球での31日を過ごせば、火星では約30日分、土星では約74.4日分に相当します。土星では、あっという間に2ヶ月が過ぎてしまいます。",
  32: "地球の32日を過ごしても、金星ではまだ1日の7分の1です。ようやく朝食の準備を始めた頃でしょうか。",
  33: "地球の33日は、海王星では約49.1日分に相当し、1ヶ月半以上になります。もう海王星の生活にすっかり馴染んでしまいました。",
  34: "地球での34日は、木星では約81.9日分、土星では約81.6日分に相当します。気づけば、木星や土星では季節が2回以上変わってしまいそうです。",
  35: "地球で35日を過ごせば、冥王星では約5.5日目。ようやく週末ですね。。",
  36: "地球での36日を過ごしても、水星ではまだ夜明け前です。水星の人は、夜の長いおしゃべりを楽しんでいそうですね。",
  37: "地球での37日は、天王星では約52日分に相当し、1ヶ月半以上になります。天王星では、あっという間に歳をとりそうです。",
  38: "地球での38日を過ごせば、木星では約91.4日分、土星では約91.2日分に相当し、3ヶ月以上になります。もうすっかり木星や土星の住人です。",
  39: "地球での39日を過ごしても、水星ではまだ夜明け前です。水星の夜は、まるで終わりのない物語のようです。",
  40: "地球での40日を過ごしても、金星ではまだ1日の6分の1です。金星の住人は、ようやくベッドから出たばかりかもしれません。",
  41: "地球での41日は、木星では約98.8日分、土星では約98.4日分に相当します。あと少しで100日になりますね。",
  42: "地球での42日を過ごしても、水星ではまだ夜明け前です。水星では、ようやく朝食の匂いが漂い始めた頃でしょうか。",
  43: "地球での43日は、海王星では約64.1日分に相当し、2ヶ月以上になります。気づけば海王星の生活が長くなってしまいました。",
  44: "地球での44日を過ごせば、冥王星では約6.8日目に入ります。もうすっかり冥王星のペースに慣れてしまいました。",
  45: "地球での45日は、火星では約43.7日分、土星では約108日分に相当し、3ヶ月以上になります。",
  46: "地球での46日を過ごしても、水星ではまだ夜明け前です。水星では、まだ深い眠りについている人が多そうです。",
  47: "地球での47日は、木星では約113日分、土星では約112.8日分に相当します。",
  48: "地球での48日を過ごしても、金星ではまだ1日の5分の1です。ようやく朝食を食べ終わった頃でしょうか。",
  49: "地球での49日を過ごしても、水星ではまだ夜明け前です。",
  50: "地球での50日は、天王星では約70.3日分に相当し、2ヶ月以上になります。天王星に住めば、あっという間に時間が過ぎてしまいそうです。",
  51: "地球での51日を過ごせば、冥王星では約8日目に入ります。冥王星の住人は、そろそろ旅行の準備を始める頃かもしれません。",
  52: "地球での52日を過ごしても、水星ではまだ夜明け前です。",
  53: "地球での53日は、木星では約127.7日分、土星では約127.2日分に相当し、4ヶ月以上になります。",
  54: "地球での54日を過ごしても、水星ではまだ夜明け前です。",
  55: "地球での55日は、海王星では約81.9日分に相当し、2ヶ月半以上になります。",
  56: "地球での56日を過ごせば、冥王星では約8.7日目に入ります。",
  57: "地球での57日を過ごしても、金星ではまだ1日の4分の1です。",
  58: "地球での58日を過ごしても、水星ではまだ夜明け前です。",
  59: "地球での59日は、木星では約142.2日分、土星では約141.6日分に相当し、4ヶ月半以上になります。",
  60: "地球での60日を過ごせば、火星では約58.2日分、土星では約144日分に相当し、4ヶ月半以上になります。",
  61: "地球での61日を過ごしても、水星ではまだ夜明け前です。",
  62: "地球での62日を過ごせば、冥王星では約9.7日目に入ります。",
  63: "地球での63日は、木星では約151.8日分、土星では約151.2日分に相当し、5ヶ月近くになります。",
  64: "地球での64日は、天王星では約90日分に相当し、3ヶ月になります。",
  65: "地球での65日を過ごしても、水星ではまだ夜明け前です。",
  66: "地球での66日を過ごしても、金星ではまだ1日の3分の1弱です。",
  67: "地球での67日を過ごせば、冥王星では約10.5日目に入ります。",
  68: "地球での68日は、木星では約163.7日分、土星では約163.2日分に相当します。",
  69: "地球での69日を過ごしても、水星ではまだ夜明け前です。",
  70: "地球での70日は、海王星では約104.3日分に相当し、3ヶ月半以上になります。",
  71: "地球での71日を過ごせば、冥王星では約11.1日目に入ります。",
  72: "地球での72日を過ごしても、水星ではまだ夜明け前です。",
  73: "地球での73日は、木星では約175.7日分、土星では約175.2日分に相当し、6ヶ月近くになります。",
  74: "地球での74日を過ごしても、金星ではまだ1日の3分の1です。",
  75: "地球での75日を過ごせば、火星では約72.8日分、土星では約180日分に相当し、6ヶ月になります。",
  76: "地球での76日を過ごしても、水星ではまだ夜明け前です。",
  77: "地球での77日を過ごせば、冥王星では約12日目に入ります。",
  78: "地球での78日は、天王星では約109.6日分に相当し、3ヶ月半以上になります。",
  79: "地球での79日を過ごしても、水星ではまだ夜明け前です。",
  80: "地球での80日は、木星では約192.8日分、土星では約192日分に相当し、6ヶ月以上になります。",
  81: "地球での81日を過ごしても、金星ではまだ1日の3分の1強です。",
  82: "地球での82日は、海王星では約122.2日分に相当し、4ヶ月以上になります。",
  83: "地球での83日を過ごせば、冥王星では約13日目に入ります。",
  84: "地球での84日を過ごしても、水星ではまだ夜明け前です。",
  85: "地球での85日は、木星では約204.8日分、土星では約204日分に相当し、6ヶ月半以上になります。",
  86: "地球での86日を過ごしても、水星ではまだ1日の半分です。夜が明けるまでにまだまだ時間がかかりそうですね。",
  87: "地球での87日は、木星では約209.6日分、土星では約208.8日分に相当し、7ヶ月近くになります。",
  88: "地球での88日を過ごしても、金星ではまだ1日の3分の1強です。",
  89: "地球での89日を過ごせば、冥王星では約13.9日目に入ります。",
  90: "地球での90日は、木星では約219日分、土星では約218.4日分に相当し、7ヶ月以上になります。",
  91: "地球での91日を過ごしても、水星ではまだ夜明け前です。水星の朝は長く、まだ始まったばかりです。",
  92: "地球での92日を過ごせば、火星では約84日分、土星では約230日分に相当し、7ヶ月半以上が経過します。",
  93: "地球での93日は、天王星では約127日分に相当し、4ヶ月以上になります。",
  94: "地球での94日を過ごしても、金星ではまだ1日の半分以下です。向こうでは、やっと昼を迎えた頃かもしれません。",
  95: "地球での95日を過ごせば、冥王星では約14.8日目に入ります。",
  96: "地球での96日は、木星では約234.8日分、土星では約234日分に相当し、実に7ヶ月半以上になります。",
  97: "地球での97日を過ごしても、水星ではまだ夜明け前です。",
  98: "地球での98日を過ごせば、海王星では約150.7日分に相当し、5ヶ月近くになります。",
  99: "地球での99日を過ごせば、冥王星では約15.3日目に入ります。もうすぐ2週間半ですね。",
  100: "地球での100日。木星では約246日分、土星では約245日分に相当します。せわしないですね。"
};

  const daysEl = document.getElementById('days');
  const hoursEl = document.getElementById('hours');
  const minutesEl = document.getElementById('minutes');
  const secondsEl = document.getElementById('seconds');
  const messageEl = document.getElementById('message');

  let prev = { days: null, hours: null, minutes: null, seconds: null };

  // GoogleカレンダーAPIから祝日取得
  async function fetchHolidays() {
    const now = new Date();
    const timeMin = now.toISOString();
    const timeMax = new Date(now.getFullYear() + 1, 11, 31).toISOString();

    const url = `https://www.googleapis.com/calendar/v3/calendars/${CALENDAR_ID}/events?key=${API_KEY}&timeMin=${timeMin}&timeMax=${timeMax}&singleEvents=true&orderBy=startTime`;
    const res = await fetch(url);
    const data = await res.json();

    if (!data.items) {
      console.error("祝日データが取得できませんでした:", data);
      return [];
    }

    // 祝日の日付だけ抽出
    return data.items.map(ev => new Date(ev.start.date));
  }

  // 土日も含めて「3日以上の連休」を探す
  function findNextLongHoliday(holidays) {
    const now = new Date();
    let date = new Date(now);

    // 今から1年先までチェック
    for (let i = 0; i < 365; i++) {
      let streak = [];
      let d = new Date(date);

      while (true) {
        const isWeekend = d.getDay() === 0 || d.getDay() === 6;
        const isHoliday = holidays.some(h => h.toDateString() === d.toDateString());

        if (isWeekend || isHoliday) {
          streak.push(new Date(d));
          d.setDate(d.getDate() + 1);
        } else {
          break;
        }
      }

      if (streak.length >= 3) {
        return streak[0]; // 3日以上連休が見つかったら開始日を返す
      }

      date.setDate(date.getDate() + 1);
    }
    return null;
  }

  function updateTimer() {
    if (!holidayDate) {
      messageEl.textContent = "次の連休を検索中…";
      return;
    }

    const now = new Date();
    let diff = Math.floor((holidayDate - now) / 1000);

    if (diff < 0) diff = 0;

    const days = Math.floor(diff / 86400);
    const hours = Math.floor((diff % 86400) / 3600);
    const minutes = Math.floor((diff % 3600) / 60);
    const seconds = diff % 60;

    if (days !== prev.days) flipDigit(daysEl, days);
    if (hours !== prev.hours) flipDigit(hoursEl, hours);
    if (minutes !== prev.minutes) flipDigit(minutesEl, minutes);
    if (seconds !== prev.seconds) flipDigit(secondsEl, seconds);

    prev = { days, hours, minutes, seconds };

    if (days >= 1 && days <= dayMessages.length) {
      messageEl.textContent = dayMessages[days - 1];
    } else if (days > dayMessages.length) {
      messageEl.textContent = "もうすぐ連休です。準備はできていますか？";
    } else {
      messageEl.textContent = "連休が始まりました！楽しんでください。";
    }
  }

  function flipDigit(el, value) {
    el.classList.remove('flip');
    void el.offsetWidth;
    el.textContent = value;
    el.classList.add('flip');
  }

  // 初期化
  (async function init() {
    const holidays = await fetchHolidays();
    holidayDate = findNextLongHoliday(holidays);
    if (!holidayDate) {
      messageEl.textContent = "今後1年以内に3日以上の連休は見つかりませんでした。";
    }
    setInterval(updateTimer, 1000);
    updateTimer();
  })();
</script>

</body>
</html>
